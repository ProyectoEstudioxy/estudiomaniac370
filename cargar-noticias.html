<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cargar noticias para Estudio Maniac 370.">
    <title>Cargar Noticias - Estudio Maniac 370</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans&display=swap" rel="stylesheet">
</head>
<body>
       <!-- Encabezado -->
       <header>
        <div class="logo">Estudio Maniac 370</div>
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="quienes-somos.html">Quiénes Somos</a></li>
                <li><a href="servicios.html">Servicios</a></li>
                <li><a href="franquicias.html">Franquicias</a></li>
                <li><a href="novedades.html">Novedades</a></li>
                <li><a href="contacto.html">Contacto</a></li>
                <li><a href="miembros.html">Miembros</a></li>
                <li><a href="planes.html">Planes</a></li>
                <li><a href="cargar-noticias.html">Cargar Noticias</a></li>
                <li><a href="indexestrategias.html">Estrategias</a></li>
            </ul>
        </nav>
    </header>
    <header>
        <div class="logo">Normativa</div>
        <div id="header-nav"></div>
        <!-- Segunda línea del encabezado para las páginas de normativa -->
        <nav class="secondary-nav">
            <ul>
                <li><a href="laboral.html">Laboral</a></li>
                <li><a href="impuestos-nacionales.html">Impuestos Nacionales</a></li>
                <li><a href="impuestos-provinciales.html">Impuestos Provinciales</a></li>
                <li><a href="sociedades-comerciales.html">Sociedades Comerciales</a></li>
                <li><a href="asociaciones-civiles.html">Asociaciones Civiles</a></li>
                <li><a href="concursos-y-quiebras.html">Concursos y Quiebras</a></li>
                <li><a href="cooperativa.html">Cooperativa</a></li>
                <li><a href="fundaciones.html">Fundaciones</a></li>
                <li><a href="mutuales.html">Mutuales</a></li>
                <li><a href="complementos-sociedades-usa.html">Complementos Sociedades en USA</a></li>
                <li><a href="jurisprudencia.html">Jurisprudencia</a></li>
                <li><a href="normas.html">Normas</a></li>
            </ul>
        </nav>
    </header>


  <!-- Barra Lateral Derecha -->
  <div class="sidebar">
    <h3>MANIAC 370</h3>
    <ul>
        <li><a></a></li>
        <li><a></a></li>
        <li><a></a></li>
        <h3>CONTABILIDAD</h3>
        <li><a href="estado-contables.html">Estado Contables</a></li>
        <li><a href="informes.html">Informes</a></li>
        <li><a href="inversores.html">Inversores</a></li>
        <li><a href="acciones.html">Acciones</a></li>
        <li><a href="costos-proyectados.html">Costos Proyectados</a></li>
        <li><a href="bienes.html">Bienes</a></li>
        <li><a href="deuda.html">Deuda</a></li>
        <li><a href="cuenta-corriente.html">Cuenta Corriente</a></li>
        <li><a>----------------------</a></li>
    </ul>
<h3>CASOS DE PRACTICOS</h3>
<div class="casos-buttons">
    <a href="casos-generales.html" class="caso-button">Casos Generales</a>
    <a href="casos-por-temas.html" class="caso-button">Casos por Temas</a>
    <a href="casos-de-liquidacion.html" class="caso-button">Casos de Liquidación</a>
</div>
</div>
    <div class="left-sidebar">
        <h3>MANIAC 370</h3>
        <ul>
            <li><a></a></li>
            <li><a></a></li>
            <li><a></a></li> 
            <li><a></a></li>
            <li><a></a></li>
            <h3>MERCADO DE CAPITALES</h3>
            <li><a href="indice-sp500.html">Índice S&P 500</a></li>
            <li><a href="bonos-tesoro.html">Bonos del Tesoro</a></li>
            <li><a href="acciones-tech.html">Acciones Tecnológicas</a></li>
            <li><a href="mercados-emergentes.html">Mercados Emergentes</a></li>
            <li><a href="tendencias-2025.html">Tendencias 2025</a></li>
        </ul>
    </div>

    <!-- Sección para Cargar Noticias -->
    <section id="cargar-noticias">
        <h1>Cargar Noticias</h1>

        <!-- Formulario para cargar una noticia manualmente -->
        <h2>Cargar Noticia Manualmente</h2>
        <form id="news-form">
            <div>
                <label for="titulo">Título:</label>
                <input type="text" id="titulo" name="titulo" required>
            </div>
            <div>
                <label for="contenido">Contenido:</label>
                <textarea id="contenido" name="contenido" rows="5" required></textarea>
            </div>
            <div>
                <label for="tema-principal">Tema Principal:</label>
                <input type="text" id="tema-principal" name="tema-principal" placeholder="Ej: Contabilidad, Criptomonedas">
            </div>
            <div>
                <label for="fuente">Link de la Fuente:</label>
                <input type="url" id="fuente" name="fuente" placeholder="Ej: https://ejemplo.com">
            </div>
            <button type="submit">Publicar Noticia</button>
        </form>
        <p id="message"></p>

        <!-- Formulario para cargar noticias desde un archivo Excel -->
        <h2>Cargar Noticias desde Excel</h2>
        <form id="excel-form" enctype="multipart/form-data">
            <div>
                <label for="excelFile">Selecciona un archivo Excel:</label>
                <input type="file" id="excelFile" name="excelFile" accept=".xlsx, .xls" required>
            </div>
            <button type="submit">Cargar Noticias desde Excel</button>
        </form>
        <p id="excel-message"></p>
    </section>

    <!-- Pie de Página -->
    <footer>
        <p>© 2025 Estudio Maniac 370. Todos los derechos reservados.</p>
        <p><a href="contacto.html">Contáctanos</a> | <a href="mailto:info@estudiomaniac370.com">info@estudiomaniac370.com</a></p>
    </footer>

    <script>
        // Formulario para cargar una noticia manualmente
        document.getElementById('news-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const titulo = document.getElementById('titulo').value;
            const contenido = document.getElementById('contenido').value;
            const tema_principal = document.getElementById('tema-principal').value;
            const fuente = document.getElementById('fuente').value;
            const message = document.getElementById('message');

            try {
                const response = await fetch('http://localhost:3000/api/noticias', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ titulo, contenido, tema_principal, fuente }),
                });

                const result = await response.json();

                if (response.ok) {
                    message.textContent = 'Noticia publicada con éxito!';
                    message.style.color = 'green';
                    document.getElementById('news-form').reset();
                } else {
                    message.textContent = 'Error al publicar la noticia: ' + result.error;
                    message.style.color = 'red';
                }
            } catch (error) {
                message.textContent = 'Error al conectar con el servidor: ' + error.message;
                message.style.color = 'red';
            }
        });

        // Formulario para cargar noticias desde un archivo Excel
        document.getElementById('excel-form').addEventListener('submit', async (e) => {
            e.preventDefault();

            const excelFile = document.getElementById('excelFile').files[0];
            const excelMessage = document.getElementById('excel-message');

            if (!excelFile) {
                excelMessage.textContent = 'Por favor, selecciona un archivo Excel.';
                excelMessage.style.color = 'red';
                return;
            }

            const formData = new FormData();
            formData.append('excelFile', excelFile);

            try {
                const response = await fetch('http://localhost:3000/api/noticias/excel', {
                    method: 'POST',
                    body: formData,
                });

                const result = await response.json();

                if (response.ok) {
                    excelMessage.textContent = result.message;
                    excelMessage.style.color = 'green';
                    document.getElementById('excel-form').reset();
                } else {
                    excelMessage.textContent = 'Error al cargar el archivo Excel: ' + result.error;
                    excelMessage.style.color = 'red';
                }
            } catch (error) {
                excelMessage.textContent = 'Error al conectar con el servidor: ' + error.message;
                excelMessage.style.color = 'red';
            }
        });
    </script>
</body>
</html>